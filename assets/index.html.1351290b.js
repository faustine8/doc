import{_ as s,c as n}from"./app.40df414d.js";const a={},e=n(`<h1 id="_5-hql-\u6570\u636E\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#_5-hql-\u6570\u636E\u64CD\u4F5C" aria-hidden="true">#</a> 5. HQL \u6570\u636E\u64CD\u4F5C</h1><h3 id="\u7B2C-1-\u8282-\u6570\u636E\u5BFC\u5165" tabindex="-1"><a class="header-anchor" href="#\u7B2C-1-\u8282-\u6570\u636E\u5BFC\u5165" aria-hidden="true">#</a> \u7B2C 1 \u8282 \u6570\u636E\u5BFC\u5165</h3><h4 id="\u88C5\u8F7D\u6570\u636E-load" tabindex="-1"><a class="header-anchor" href="#\u88C5\u8F7D\u6570\u636E-load" aria-hidden="true">#</a> \u88C5\u8F7D\u6570\u636E(Load)</h4><p>\u57FA\u672C\u8BED\u6CD5:</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">LOAD</span> <span class="token keyword">DATA</span> <span class="token punctuation">[</span><span class="token keyword">LOCAL</span><span class="token punctuation">]</span> INPATH <span class="token string">&#39;filepath&#39;</span>
    <span class="token punctuation">[</span>OVERWRITE<span class="token punctuation">]</span> <span class="token keyword">INTO</span> <span class="token keyword">TABLE</span> tablename <span class="token punctuation">[</span><span class="token keyword">PARTITION</span> <span class="token punctuation">(</span>partcol1<span class="token operator">=</span>val1<span class="token punctuation">,</span> partcol2<span class="token operator">=</span>val2 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>LOCAL: <ul><li>LOAD DATA LOCAL ... \u4ECE\u672C\u5730\u6587\u4EF6\u7CFB\u7EDF\u52A0\u8F7D\u6570\u636E\u5230Hive\u8868\u4E2D\u3002\u672C\u5730\u6587\u4EF6\u4F1A<em>\u62F7\u8D1D</em>\u5230Hive\u8868\u6307\u5B9A\u7684\u4F4D\u7F6E</li><li>LOAD DATA ... \u4ECEHDFS\u52A0\u8F7D\u6570\u636E\u5230Hive\u8868\u4E2D\u3002HDFS\u6587\u4EF6<em>\u79FB\u52A8</em>\u5230Hive\u8868\u6307\u5B9A\u7684\u4F4D\u7F6E</li></ul></li><li>INPATH: \u52A0\u8F7D\u6570\u636E\u7684\u8DEF\u5F84</li><li>OVERWRITE: \u8986\u76D6\u8868\u4E2D\u5DF2\u6709\u6570\u636E;\u5426\u5219\u8868\u793A\u8FFD\u52A0\u6570\u636E</li><li>PARTITION: \u5C06\u6570\u636E\u52A0\u8F7D\u5230\u6307\u5B9A\u7684\u5206\u533A</li></ul><p>\u51C6\u5907\u5DE5\u4F5C:</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- \u521B\u5EFA\u8868</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> tabA <span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  name string<span class="token punctuation">,</span>
  area string
<span class="token punctuation">)</span> <span class="token keyword">ROW</span> FORMAT DELIMITED <span class="token keyword">FIELDS</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">&#39;,&#39;</span> <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>\u6570\u636E\u6587\u4EF6 (~/data/sourceA.txt):</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>1,fish1,SZ
2,fish2,SH
3,fish3,HZ
4,fish4,QD
5,fish5,SR
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>\u62F7\u8D1D\u6587\u4EF6\u5230 HDFS</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>hdfs dfs -put sourceA.txt data/
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>\u88C5\u8F7D\u6570\u636E:</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- \u52A0\u8F7D\u672C\u5730\u6587\u4EF6\u5230hive(tabA)</span>
<span class="token keyword">LOAD</span> <span class="token keyword">DATA</span> <span class="token keyword">LOCAL</span> INPATH <span class="token string">&#39;/home/hadoop/data/sourceA.txt&#39;</span> <span class="token keyword">INTO</span> <span class="token keyword">TABLE</span> tabA<span class="token punctuation">;</span>
<span class="token comment">-- \u68C0\u67E5\u672C\u5730\u6587\u4EF6\u8FD8\u5728</span>

<span class="token comment">-- \u52A0\u8F7Dhdfs\u6587\u4EF6\u5230hive(tabA)</span>
<span class="token keyword">LOAD</span> <span class="token keyword">DATA</span> INPATH <span class="token string">&#39;/user/root/data/sourceA.txt&#39;</span> <span class="token keyword">INTO</span> <span class="token keyword">TABLE</span> tabA<span class="token punctuation">;</span>
<span class="token comment">-- \u68C0\u67E5HDFS\u6587\u4EF6\uFF0C\u5DF2\u7ECF\u88AB\u8F6C\u79FB</span>

<span class="token comment">-- \u52A0\u8F7D\u6570\u636E\u8986\u76D6\u8868\u4E2D\u5DF2\u6709\u6570\u636E</span>
<span class="token keyword">LOAD</span> <span class="token keyword">DATA</span> <span class="token keyword">LOCAL</span> INPATH <span class="token string">&#39;/home/hadoop/data/sourceA.txt&#39;</span> OVERWRITE <span class="token keyword">INTO</span> <span class="token keyword">TABLE</span> tabA<span class="token punctuation">;</span>

<span class="token comment">-- \u521B\u5EFA\u8868\u65F6\u52A0\u8F7D\u6570\u636E</span>
hdfs dfs <span class="token operator">-</span>mkdir <span class="token operator">/</span><span class="token keyword">user</span><span class="token operator">/</span>hive<span class="token operator">/</span>tabB
hdfs dfs <span class="token operator">-</span>put sourceA<span class="token punctuation">.</span>txt <span class="token operator">/</span><span class="token keyword">user</span><span class="token operator">/</span>hive<span class="token operator">/</span>tabB

<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> tabB <span class="token punctuation">(</span>
    id <span class="token keyword">INT</span><span class="token punctuation">,</span>
    name string<span class="token punctuation">,</span>
    area string
<span class="token punctuation">)</span> 
<span class="token keyword">ROW</span> FORMAT DELIMITED <span class="token keyword">FIELDS</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">&#39;,&#39;</span>
Location <span class="token string">&#39;/user/hive/tabB&#39;</span><span class="token punctuation">;</span>

<span class="token comment"># \u67E5\u770B\u6570\u636E</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> tabB<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h4 id="\u63D2\u5165\u6570\u636E-insert" tabindex="-1"><a class="header-anchor" href="#\u63D2\u5165\u6570\u636E-insert" aria-hidden="true">#</a> \u63D2\u5165\u6570\u636E(Insert)</h4><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- \u521B\u5EFA\u5206\u533A\u8868</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> tabC <span class="token punctuation">(</span>
  id <span class="token keyword">int</span><span class="token punctuation">,</span>
  name string<span class="token punctuation">,</span>
  area string
<span class="token punctuation">)</span>
partitioned <span class="token keyword">by</span> <span class="token punctuation">(</span><span class="token keyword">month</span> string<span class="token punctuation">)</span>
<span class="token keyword">ROW</span> FORMAT DELIMITED <span class="token keyword">FIELDS</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span> <span class="token string">&#39;,&#39;</span><span class="token punctuation">;</span>

<span class="token comment">-- \u63D2\u5165\u6570\u636E</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token keyword">table</span> tabC <span class="token keyword">partition</span><span class="token punctuation">(</span><span class="token keyword">month</span><span class="token operator">=</span><span class="token string">&#39;202201&#39;</span><span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">&#39;wangwu&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;BJ&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">&#39;lishi&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;SH&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&#39;zhangsan&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;TJ&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- \u63D2\u5165\u67E5\u8BE2\u7684\u7ED3\u679C\u6570\u636E</span>
<span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token keyword">table</span> tabC <span class="token keyword">partition</span><span class="token punctuation">(</span><span class="token keyword">month</span><span class="token operator">=</span><span class="token string">&#39;202202&#39;</span><span class="token punctuation">)</span> <span class="token keyword">select</span> id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> area <span class="token keyword">from</span> tabC <span class="token keyword">where</span> <span class="token keyword">month</span><span class="token operator">=</span><span class="token string">&#39;202201&#39;</span><span class="token punctuation">;</span>
<span class="token comment">-- \u6B64\u5904\u4E0D\u80FD\u4F7F\u7528 select * from tabC, \u56E0\u4E3A\u7ED3\u679C\u4F1A\u591A\u4E00\u4E2A\u6B64\u5904\u5E76\u4E0D\u9700\u8981\u7684\u4F2A\u5217\uFF1Amonth</span>


<span class="token comment">-- \u591A\u8868(\u591A\u5206\u533A)\u63D2\u5165\u6A21\u5F0F</span>
<span class="token keyword">from</span> tabC <span class="token keyword">insert</span> overwrite <span class="token keyword">table</span> tabC <span class="token keyword">partition</span><span class="token punctuation">(</span><span class="token keyword">month</span><span class="token operator">=</span><span class="token string">&#39;202203&#39;</span><span class="token punctuation">)</span> <span class="token keyword">select</span> id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> area <span class="token keyword">where</span> <span class="token keyword">month</span><span class="token operator">=</span><span class="token string">&#39;202201&#39;</span>
    <span class="token keyword">insert</span> overwrite <span class="token keyword">table</span> tabC <span class="token keyword">partition</span><span class="token punctuation">(</span><span class="token keyword">month</span><span class="token operator">=</span><span class="token string">&#39;202204&#39;</span><span class="token punctuation">)</span> <span class="token keyword">select</span> id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> area <span class="token keyword">where</span> <span class="token keyword">month</span><span class="token operator">=</span><span class="token string">&#39;202002&#39;</span> <span class="token operator">or</span> <span class="token keyword">month</span><span class="token operator">=</span><span class="token string">&#39;202201&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>\u521B\u5EFA\u8868\u5E76\u63D2\u5165\u6570\u636E(as select)</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- \u6839\u636E\u67E5\u8BE2\u7ED3\u679C\u521B\u5EFA\u8868</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> tabD <span class="token keyword">as</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tabC<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>\u4F7F\u7528import\u5BFC\u5165\u6570\u636E</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">import</span> <span class="token keyword">table</span> student2 <span class="token keyword">partition</span><span class="token punctuation">(</span><span class="token keyword">month</span><span class="token operator">=</span><span class="token string">&#39;201709&#39;</span><span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token string">&#39;/user/hive/warehouse/export/student&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="\u7B2C-2-\u8282-\u6570\u636E\u5BFC\u51FA" tabindex="-1"><a class="header-anchor" href="#\u7B2C-2-\u8282-\u6570\u636E\u5BFC\u51FA" aria-hidden="true">#</a> \u7B2C 2 \u8282 \u6570\u636E\u5BFC\u51FA</h3><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- \u5C06\u67E5\u8BE2\u7ED3\u679C\u5BFC\u51FA\u5230\u672C\u5730</span>
<span class="token keyword">insert</span> overwrite <span class="token keyword">local</span> directory <span class="token string">&#39;/home/hadoop/data/tabC&#39;</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tabC<span class="token punctuation">;</span>

<span class="token comment">-- \u5C06\u67E5\u8BE2\u7ED3\u679C\u683C\u5F0F\u5316\u8F93\u51FA\u5230\u672C\u5730</span>
<span class="token keyword">insert</span> overwrite <span class="token keyword">local</span> directory <span class="token string">&#39;/home/hadoop/data/tabC2&#39;</span> <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">&#39; &#39;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tabC<span class="token punctuation">;</span>

<span class="token comment">-- \u5C06\u67E5\u8BE2\u7ED3\u679C\u5BFC\u51FA\u5230HDFS</span>
<span class="token keyword">insert</span> overwrite directory <span class="token string">&#39;/user/hadoop/data/tabC3&#39;</span> <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">&#39; &#39;</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> tabC<span class="token punctuation">;</span>
<span class="token comment">-- \u67E5\u770Bhdfs\u5BFC\u51FA\u7ED3\u679C</span>
hdfs dfs <span class="token operator">-</span>cat <span class="token operator">/</span><span class="token keyword">user</span><span class="token operator">/</span>hadoop<span class="token operator">/</span><span class="token keyword">data</span><span class="token operator">/</span>tabC3<span class="token operator">/</span><span class="token operator">*</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>dfs \u547D\u4EE4\u5BFC\u51FA\u6570\u636E\u5230\u672C\u5730\u3002(\u672C\u8D28\u662F\u6267\u884C\u6570\u636E\u6587\u4EF6\u7684\u62F7\u8D1D)</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>hive <span class="token punctuation">(</span>mydb<span class="token punctuation">)</span><span class="token operator">&gt;</span> dfs -get /user/hive/warehouse/mydb.db/tabc/month<span class="token operator">=</span><span class="token number">202201</span> /home/hadoop/data/tabC4<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>hive \u547D\u4EE4\u5BFC\u51FA\u6570\u636E\u5230\u672C\u5730\u3002(\u672C\u8D28\u662F\uFF1A\u6267\u884C\u67E5\u8BE2\u5C06\u67E5\u8BE2\u7ED3\u679C\u91CD\u5B9A\u5411\u5230\u6587\u4EF6)</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u4E0D\u9700\u8FDB\u5165 Hive \u547D\u4EE4\u884C</span>
hive -e <span class="token string">&quot;select * from mydb.tabC&quot;</span> <span class="token operator">&gt;</span> a.log
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># export \u5BFC\u51FA\u6570\u636E\u5230HDFS\u3002</span>
<span class="token comment"># \u4F7F\u7528export\u5BFC\u51FA\u6570\u636E\u65F6\uFF0C\u4E0D\u4EC5\u6709\u6570\u636E\u8FD8\u6709\u8868\u7684\u5143\u6570\u636E\u4FE1\u606F</span>
hive <span class="token punctuation">(</span>mydb<span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token builtin class-name">export</span> table tabC to <span class="token string">&#39;/user/root/data/tabC4&#39;</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span>root@linux121 ~<span class="token punctuation">]</span><span class="token comment"># hdfs dfs -ls /user/root/data/tabC4/</span>
Found <span class="token number">5</span> items
-rwxr-xr-x   <span class="token number">3</span> root supergroup       <span class="token number">6206</span> <span class="token number">2022</span>-02-16 <span class="token number">16</span>:51 /user/root/data/tabC4/_metadata
drwxr-xr-x   - root supergroup          <span class="token number">0</span> <span class="token number">2022</span>-02-16 <span class="token number">16</span>:51 /user/root/data/tabC4/month<span class="token operator">=</span><span class="token number">202201</span>
drwxr-xr-x   - root supergroup          <span class="token number">0</span> <span class="token number">2022</span>-02-16 <span class="token number">16</span>:51 /user/root/data/tabC4/month<span class="token operator">=</span><span class="token number">202202</span>
drwxr-xr-x   - root supergroup          <span class="token number">0</span> <span class="token number">2022</span>-02-16 <span class="token number">16</span>:51 /user/root/data/tabC4/month<span class="token operator">=</span><span class="token number">202203</span>
drwxr-xr-x   - root supergroup          <span class="token number">0</span> <span class="token number">2022</span>-02-16 <span class="token number">16</span>:51 /user/root/data/tabC4/month<span class="token operator">=</span><span class="token number">202204</span>


<span class="token comment"># export \u5BFC\u51FA\u7684\u6570\u636E\uFF0C\u53EF\u4EE5\u4F7F\u7528 import \u547D\u4EE4\u5BFC\u5165\u5230 Hive \u8868\u4E2D</span>
<span class="token comment"># \u4F7F\u7528 LIKE tname \u521B\u5EFA\u7684\u8868\u7ED3\u6784\u4E0E\u539F\u8868\u4E00\u81F4\u3002create ... AS select ... \u7ED3\u6784\u53EF\u80FD\u4E0D\u4E00\u81F4.(\u5982\uFF1A\u4E22\u5931 partition \u4FE1\u606F)</span>
hive <span class="token punctuation">(</span>mydb<span class="token punctuation">)</span><span class="token operator">&gt;</span> create table tabE like tabC<span class="token punctuation">;</span>
hive <span class="token punctuation">(</span>mydb<span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token function">import</span> table tabE from <span class="token string">&#39;/user/root/data/tabC4&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- \u622A\u65AD\u8868\uFF0C\u6E05\u7A7A\u6570\u636E\u3002(\u6CE8\u610F:\u4EC5\u80FD\u64CD\u4F5C\u5185\u90E8\u8868)</span>
<span class="token keyword">truncate</span> <span class="token keyword">table</span> tabE<span class="token punctuation">;</span>

<span class="token comment">-- \u4EE5\u4E0B\u8BED\u53E5\u62A5\u9519\uFF0C\u5916\u90E8\u8868\u4E0D\u80FD\u6267\u884C truncate \u64CD\u4F5C</span>
hive <span class="token punctuation">(</span>mydb<span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token keyword">alter</span> <span class="token keyword">table</span> tabC <span class="token keyword">set</span> tblproperties<span class="token punctuation">(</span><span class="token string">&quot;EXTERNAL&quot;</span><span class="token operator">=</span><span class="token string">&quot;TRUE&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
OK
<span class="token keyword">Time</span> taken: <span class="token number">0.137</span> seconds

hive <span class="token punctuation">(</span>mydb<span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token keyword">truncate</span> <span class="token keyword">table</span> tabC<span class="token punctuation">;</span>
FAILED: SemanticException <span class="token punctuation">[</span>Error <span class="token number">10146</span><span class="token punctuation">]</span>: Cannot <span class="token keyword">truncate</span> non<span class="token operator">-</span>managed <span class="token keyword">table</span> tabC<span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>\u5C0F\u7ED3</strong></p><ul><li>\u6570\u636E\u5BFC\u5165: <code>load data</code>/<code>insert</code>/<code>create table .... as select .....</code>/<code>import table</code></li><li>\u6570\u636E\u5BFC\u51FA: <code>insert overwrite ... diretory ...</code>/<code>hdfs dfs -get</code>/<code>hive -e &quot;select ...&quot; &gt; a.log</code>/<code>export table ...</code></li></ul><p>Hive \u7684\u6570\u636E\u5BFC\u5165\u4E0E\u5BFC\u51FA\u8FD8\u53EF\u4EE5\u4F7F\u7528\u5176\u4ED6\u5DE5\u5177\uFF0C\u5982Sqoop\u3001DataX\u7B49\u3002</p>`,31);function p(t,o){return e}var r=s(a,[["render",p],["__file","index.html.vue"]]);export{r as default};
